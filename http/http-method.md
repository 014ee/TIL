# HTTP Method

## API URI 설계 방법

#### 1. 리소스와 행위를 분리한다.

* 리소스: 회원, 상품 등 (계층 구조상 상위를 컬렉션으로 보고 복수 단어 사용 권)
* 행위: 조회, 등록, 삭제, 변경

#### 2. URI 계층 구조를 활용한다.  (리소스만으로 설계하기 어려울 때는 컨트롤 URI를 사용하기도 한다.)

* 회원목록조회/members
* 회원 조회 /members/{id}
* 회원 등록 /members/{id}
* 회원 수정 /members/{id}
* 회원 삭제 /members/{id}



## GET

{% hint style="info" %}
리소스를 조회한다.
{% endhint %}

* 서버에 전달하고 싶은 데이터는 query(쿼리 파라미터, 쿼리 스트링)을 통해서 전달한다.
* 메세지 바디를 사용해서 데이터를 전달할 수도 있지만 지원하지 않는 곳이 많아서 권장하지 않는다.



## POST

{% hint style="info" %}
메세지 바디에 데이터를 담아 전달하면 서버는 리소스 URI에 미리 지정된 로직에 따라 요청 데이터를 처리한다. 즉, 리소스 URI에 post 요청이 오면 요청 데이터를 어떻게 처리할지 리소스마다 따로 정해야 한다. (주로 등록에 사용)
{% endhint %}

* 신규 데이터 등록, 프로세스 처리 (ex. 배달 버튼을 누르면 배달 관련 프로세스 진행 )
* HTML 폼에 입력된 데이터 처리 (ex. 회원가입, 주문 등)
* 게시판, 뉴스, 메일, 블로그, 댓글 등에 내용 게시
* 서버가 아직 식별하지 않은 새 리소스 생성 (신규 주문 생성)
* 기존 자원에 데이터 추가
* 새 리소스를 생성하고 등록
* 요청 데이터 처리
* 다른 메서드로 처리하기 어려운 경우&#x20;

## PUT

{% hint style="info" %}
리소스가 있으면 생성, 없으면 완전히 덮어쓴다. (기존 리소스를 전부 삭제한 후 추가)
{% endhint %}

* 클라이언트가 리소스의 위치를 알고 URI를 직접 지정하여 요청한다는 것이 post와 다르다.
* 완전히 덮어써야 하거나 덮어쓸 수 있는 데이터가 아니면 put 대신 patch를 써야한다.&#x20;



## Patch

{% hint style="info" %}
리소스를 부분적으로 변경(수정)한다.
{% endhint %}

* patch를 지원하지 않는 서버에서는 post로 대체한다.



## Delete

{% hint style="info" %}
리소스를 제거한다.
{% endhint %}



## 기타 메서드

* `HEAD`: GET과 동일하지만 메세지 부분을 제외하고 상태줄과 헤더만 반환
* `OPTIONS`: 대상 리소스에 대한 통신 가능 옵션을 설명



## 메서드 속성

#### 안전 (GET)

{% hint style="info" %}
호출해도 리소스를 변경하지 않는다.&#x20;
{% endhint %}

#### 멱등 (GET, PUT, DELETE)

{% hint style="info" %}
한 번이든 1000번이든 똑같은 요청을 하면 똑같은 결과를 응답해야 한다. 때문에 자동 복구 메커니즘에서 활용 가능하다. (ex. 서버가 timeout 등으로 정상 응답을 하지 못했을 대 클라이언트가 자동으로 같은 요청을 다시 해도 되는가에 대해 판단 근거 / 단, 외부 요인으로 중간에 리소스가 변경되는 것 까지는 고려하지 않으므로 중간에 데이터가 변경될 여지가 있다.)
{% endhint %}

**캐시가능 (GET, HEAD, POST, PATCH)**

{% hint style="info" %}
응답 결과 리소스를 캐시해서 사용해도 되는지 결정 (GET, HEAD, POST, PATCH가 캐시 가능하나 본문 내용까지 캐시 키를 고려하 것은 구현이 어려우므로 실무에서는GET, HEAD 정도만 캐시로 사용함)
{% endhint %}



## 클라이언트에서 서버로 데이터 요청하기

* 쿼리 파라미터 없이 경로만 요청하는 이미지, 정적 텍스트 문서 등과 같은 정적 데이터 조회 (get)
* 쿼리 파라미터를 사용하는 검색, 게시판 목록 정렬 필터 등과 같은 동적 데이터 조회 (get)
* &#x20;HTML Form을 통한 메세지 바디 전송 (get, post)\
  ex. 회원가입, 상품주문, 리소스 등록, 리소스 변경 등 데이터 전송)\
  데이터를 전송하면 form 내용을 key=value 쿼리 파라미터 형식으로 메세지 바디를 통해 전송한다. \
  Content-Type은 기본으로 application/x-www-form-urlencoded 사용\
  파일 업로드 같은 바이너리 데이터 전송시에는 Content-Type: multipart/form-data 사용
* HTTP API를 통한 회원가입, 상품주문, 데이터 변경, 서버 TO 서버, 앱 클라이언트, 웹 클라이언트(AJAX) 데이터 전송 (라이브러리 잘 돼있는거 많음)\
  Content-Type은 application/json을 주로 사용



## HTTP API 설계 예시

#### 1. 컬렉션: Post 기반 (회원관리 api 제공)&#x20;

#### 2. 스토어: Put 기반 (정적 컨텐츠 관리, 원격 파일 관리)

#### 3. HTML FORM: Get, Post만 지원 (웹페이지 회원관리, ajax 사용시 다른 메서드도 사용 가능)

get, post만 지원하는 제약을 해결하기 위해 컨트롤 URI(동사로 된 리소스)를 사용한다.&#x20;
